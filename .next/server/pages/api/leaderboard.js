"use strict";(()=>{var e={};e.id=452,e.ids=[452],e.modules={2744:(e,r,t)=>{t.a(e,async(e,n)=>{try{t.d(r,{_:()=>o});var a=t(2971),s=e([a]);let i=(a=(s.then?(await s)():s)[0]).z.object({SUPABASE_URL:a.z.string().url("Invalid Supabase URL"),SUPABASE_SERVICE_ROLE_KEY:a.z.string().min(1,"Supabase service role key is required"),SUPABASE_ANON_KEY:a.z.string().min(1,"Supabase anon key is required"),JWT_SECRET:a.z.string().min(1,"JWT secret is required"),DB_PROVIDER:a.z.literal("supabase").describe('Must be "supabase"'),NODE_ENV:a.z.enum(["development","production","test"]).default("development"),PORT:a.z.string().transform(Number).default("3001")}),o=function(){try{return i.parse(process.env)}catch(e){if(e instanceof a.z.ZodError){let r=e.issues.map(e=>`${e.path.join(".")}: ${e.message}`).join("\n");throw Error(`Invalid server environment variables:
${r}`)}throw e}}();n()}catch(e){n(e)}})},2971:e=>{e.exports=import("zod")},3480:(e,r,t)=>{e.exports=t(5600)},3939:e=>{e.exports=require("@supabase/supabase-js")},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6435:(e,r)=>{Object.defineProperty(r,"M",{enumerable:!0,get:function(){return function e(r,t){return t in r?r[t]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,t)):"function"==typeof r&&"default"===t?r:void 0}}})},7118:(e,r,t)=>{t.a(e,async(e,n)=>{try{t.r(r),t.d(r,{config:()=>l,default:()=>u,routeModule:()=>c});var a=t(3480),s=t(8667),i=t(6435),o=t(8522),d=e([o]);o=(d.then?(await d)():d)[0];let u=(0,i.M)(o,"default"),l=(0,i.M)(o,"config"),c=new a.PagesAPIRouteModule({definition:{kind:s.A.PAGES_API,page:"/api/leaderboard",pathname:"/api/leaderboard",bundlePath:"",filename:""},userland:o});n()}catch(e){n(e)}})},8522:(e,r,t)=>{t.a(e,async(e,n)=>{try{t.r(r),t.d(r,{default:()=>o});var a=t(3939),s=t(2744),i=e([s]);s=(i.then?(await i)():i)[0];let d=(0,a.createClient)(s._.SUPABASE_URL,s._.SUPABASE_SERVICE_ROLE_KEY);async function o(e,r){if("GET"!==e.method)return r.status(405).json({error:"Method not allowed"});let{wordId:t,playerId:n}=e.query;if(!t||"string"!=typeof t)return r.status(400).json({error:"wordId is required"});try{let e=new Date().toISOString().split("T")[0],{data:a,error:s}=await d.from("leaderboard_summary").select("*").eq("word_id",t).eq("date",e).order("guesses_used",{ascending:!0}).order("completion_time_seconds",{ascending:!0});if(s)return console.error("Error fetching all leaderboard entries:",s),r.status(500).json({error:"Failed to fetch leaderboard"});let i=null,o=null;if(n&&"string"==typeof n&&a&&(i=a.find(e=>e.player_id===n)??null)){let e=a.findIndex(e=>e.player_id===n);o=e>=0?e+1:null}let u=a?.slice(0,10)??[],l=[...u];return i&&!u.some(e=>e.player_id===n)&&l.push({...i,is_current_player:!0}),r.status(200).json({leaderboard:l,playerRank:o,totalEntries:a?.length??0})}catch(e){return console.error("Error in leaderboard endpoint:",e),r.status(500).json({error:"Internal server error"})}}n()}catch(e){n(e)}})},8667:(e,r)=>{Object.defineProperty(r,"A",{enumerable:!0,get:function(){return t}});var t=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})}};var r=require("../../webpack-api-runtime.js");r.C(e);var t=r(r.s=7118);module.exports=t})();